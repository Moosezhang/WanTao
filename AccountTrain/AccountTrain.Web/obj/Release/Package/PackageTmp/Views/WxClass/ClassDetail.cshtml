
@{
     ViewBag.Title = "课程详情";
}


<style>
.div-inline { 
	display:inline;
	float: left;
	text-align:center;
	line-height: 35px;
} 

ul li{
list-style-type:none;
}

.zoomImage{
    width:100%;
    height:0;
    padding-bottom: 45%;
    overflow:hidden;
    background-position: center center;
    background-repeat: no-repeat;
    -webkit-background-size:cover;
    -moz-background-size:cover;
    background-size:cover;
}
</style>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="yes" name="apple-mobile-web-app-capable" />
	<meta content="black" name="apple-mobile-web-app-status-bar-style" />
	<meta content="telephone=no" name="format-detection" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta charset="UTF-8" />
    <title>课程详情</title>
</head>
<body>
  	<header data-am-widget="header" class="am-header am-header-default" style="background-color: white;">
	  <div class="am-header-left am-header-nav">
		    <a href="javascript:window.history.back(); " class="">
		  		<img class="am-header-icon-custom" src="~/Images/icon/返回.png" alt=""/>
		  	</a>
	  </div>
	   <h3 class="am-header-title" 
	   	style="width:100px;float:left;color: black;padding-top: 15px;font-size: 18px;margin-right: 0px;">
          课程详情
      </h3>
  		<div class="am-input-group" >	
	      <span class="am-input-group-btn" >
	      	<button class="am-btn" type="button" onclick="GoHome()" 
	        	style="margin-top: 3px;float:right;background-color: white;border-color:white;">
	        	<div><img class="am-header-icon-custom" src="~/Images/icon/主页.png" style="height: 20px;" alt=""/></div>
	        </button>
	        <button class="am-btn" type="button" onclick="GoCar()" 
	        	style="margin-top: 3px;float:right;background-color: white;border-color:white;">
	        	<div><img class="am-header-icon-custom" src="~/Images/icon/购物车.png" style="height: 20px;" alt=""/></div>
	        </button>
	      
	      </span>
	    </div>
	</header>
  	<hr style="margin-top: 0px;margin-bottom: 5px;"/>
  	<div>
  		<form class="am-form">
	        <fieldset>
	        	<div id="myVideo">
	        		<div v-if="status==1 || !isVideo" class="zoomImage" style="height:160px" v-bind:style="{backgroundImage:'url(' + imgUrl + ')'}"></div>
	            	<video v-if="status==2 && isVideo"  v-bind:src="currVideoUrl"  width="100%" height="160" controls>				  	
					</video>
					<audio v-if="status==2 && !isVideo" v-bind:src="currVideoUrl" style="width: 100%;" controls>
					</audio>					
                </div>
	            <div id="detail" model="form">
	            	<div style="margin-left: 15px;">
	            		<h4>{{form.ClassName}}</h4>
	            		<table style="width: 100%;">
	            			<tr>
								<th v-if="!isVir" style="width: 33%;"  >
									<span style="color: red;font-size: 15px;">¥  {{form.ClassPrice}}</span>
								</th>
								
								<th v-if="isVir" style="width: 55%;"  >
									<span style="color: red;font-size: 15px;">¥  {{form.ClassPrice}} 抢购</span>
									<span style="text-decoration:line-through;color: #666666;font-size: 13px;">原价:¥{{form.VirPrice}}</span>
								</th>
								
								<th v-if="isVir" style="width: 23%; padding-bottom: 5px;">
									<div style="color: #999999;padding-top: 5px"><img style="margin-right: 3px; height: 18px;" class="am-header-icon-custom" src="~/Images/icon/眼睛.png" alt=""/>{{ClickCount}}</div>
								</th>
								<th v-if="!isVir" style="width: 33%; padding-bottom: 5px;">
									<div style="color: #999999;padding-top: 5px"><img style="margin-right: 3px; height: 18px;" class="am-header-icon-custom" src="~/Images/icon/眼睛.png" alt=""/>{{ClickCount}}</div>
								</th>
								<th style="width: 33%; padding-bottom: 5px;">
									<div v-if="isLike" style="color: #999999;padding-top: 5px;float: right;padding-right: 10px;"><img v-on:click="GoLike()" style="margin-bottom: 4px;margin-right: 3px;height:18px;" class="am-header-icon-custom" src="~/Images/icon/已点赞.png" alt=""/>赞 ({{likeCount}})</div>
									<div v-if="!isLike" style="color: #999999;padding-top: 5px;float: right;padding-right: 10px;"><img v-on:click="GoLike()" style="margin-bottom: 4px;margin-right: 3px; height: 18px;  " class="am-header-icon-custom" src="~/Images/icon/未点赞.png" alt=""/>赞 ({{likeCount}})</div>
								</th>
							</tr>
	            		</table>
	            	</div>
	            	
	            	<div v-if="isFunds" style="width: 100%;height: 15px;background: #E0E0E0;"></div>
	            	
	            	<div v-if="isFunds" style="height: 65px;width: 100%;">
	            		<div style="line-height:65px;width: 20%;float: left;text-align: center;">
	            			<img style="width: 40px;" class="am-header-icon-custom" src="~/Images/icon/funds.png" alt=""/>
	            		</div>
	            		<div style="width: 80%;float: right;padding-top: 10px;padding-left: 5px;padding-right: 5px;">
	            			<b>公益宝贝</b>
	            			<div style="color: #666666;font-size: 12px;">
	            				每笔成交将为 <span >{{fundsForm.FundsText}}</span> 捐赠 <span>{{fundsForm.FundsPrice}}<span> 元，已累计捐赠 <span>{{form.HotCount}}</span> 笔
	            			</div>
	            		</div>
	            	</div>
	            	
	            	<div v-if="form.IsGroupBuy=='1'" style="width: 100%;height: 15px;background: #E0E0E0;"></div>
	            	
	            	<div v-if="form.IsGroupBuy=='1'">
	            		
	                	<div style="font-size: 15px;margin-top: 5px;color: #444444;margin-left: 10px;width: 100%;height: 25px;">
	                	 	<div style="width: 70%;float:left">
	                	 		剩余时间:
	                	 		<span style="color: red;" id="_d">00</span>  
					         	<span style="color: red;" id="_h">00</span>  
					         	<span style="color: red;" id="_m">00</span>  
					        	<span style="color: red;" id="_s">00</span> 
	                	 	</div>		      
				        	<div style="width: 30%;float: right;">
				        		<span style="color: #4395ff;">{{HotCount}}</span>
				        		<span style="color: #999999;">人已购买</span>
				        	</div>
				        	
	                	</div>
		               			                
		               	<hr style="margin-top: 0px;margin-bottom: 5px;width: 100%;"/>
		               	<div style="font-size: 15px;margin-left: 10px;margin-bottom: 5px;width: 100%;">
						  <span style="color: #4395ff;">{{NowCount}}</span>人正在拼图，还差<span style="color: #4395ff;">{{NeedCount-NowCount}}</span>人满团，立即团购
						  <img style="height: 15px;" class="am-header-icon-custom" src="~/Images/icon/喇叭.png" />
	            		</div>
	            	</div>
	            	
	            	<div style="width: 100%;height: 15px;background: #E0E0E0;"></div>
	            	
	            	
				  <el-tabs v-model="activeName"  style="width: 100%;" stretch="true">
				    <el-tab-pane label="课程信息" name="first">
				    	<div style="overflow-y: auto;">
				        	<div id="contentData">
                			</div>
					    </div>
				    </el-tab-pane>
				    <el-tab-pane label="课程大纲" name="second">
				    	<div style="overflow-y: auto;">
					        <ul v-for="item in capData" style="margin-bottom: -1px;padding-left: 0px;">
							    <li><img class="am-header-icon-custom" style="height: 50px;" src="~/Images/icon/line_b.png" alt=""/><span style="margin-left: 10px;" v-on:click="changeVideo(item)">{{item.ChapterTitle}}</span></li>
							</ul>
					    </div>
				    </el-tab-pane>
				  </el-tabs>
					
	            	
	            	<!--<div data-am-widget="tabs" class="am-tabs am-tabs-d2" style="margin: 0px;">
						  <ul class="am-tabs-nav am-cf" >
						      <li class="am-active" ><a style=" text-decoration: none;" href="[data-tab-panel-0]">课程信息</a></li>
						      <li ><a style=" text-decoration: none;" href="[data-tab-panel-1]">课程大纲</a></li>
						  </ul>
						  <div class="am-tabs-bd" style="border: hidden;">
						      <div data-tab-panel-0 class="am-tab-panel am-active" style="overflow-y: auto;">
						        	<div  id="contentData">
                        			</div>
						      </div>
						      <div data-tab-panel-1 class="am-tab-panel " style="overflow-y: auto;">
						        <ul v-for="item in capData" style="margin-bottom: -1px;padding-left: 0px;">
								    <li><img class="am-header-icon-custom" style="height: 50px;" src="~/Images/icon/line_b.png" alt=""/><span style="margin-left: 10px;" v-on:click="changeVideo(item)">{{item.ChapterTitle}}</span></li>
								</ul>
						      </div>
						  </div>
					</div>-->
					<header class="am-topbar  am-topbar-fixed-bottom" style="height: 40px;">
						<div class="div-inline" v-if="form.IsGroupBuy=='1' && status!=2" v-on:click="GoGroupBuy()" style="margin-left: 10px;margin-top: 7px;width: 45%;border-radius:55px;color: white;font-size: 15px;height: 35px;background-color: #ff8a00;"  >
							团购价:¥ {{GroupPrice}}
						</div>	
						<div class="div-inline" v-if="form.IsBargain=='1' && status!=2 " v-on:click="GoBargain(form.ClassPrice)" style="margin-left: 10px;margin-top: 7px;width: 20%;border-radius:55px;color: #332c25;font-size: 15px;height: 35px;background-color: #f9d001;"  >
							我要砍价
						</div>	
						<div class="div-inline" v-if="form.IsBargain=='1' && status!=2 && bargainId!=null"  style="margin-left: 10px;margin-top: 7px;width: 30%;border-radius:55px;color: #332c25;font-size: 15px;height: 35px;background-color: #f9d001;"  >
							现价:¥ {{nowPrice}}
						</div>
						<div class="div-inline" v-if="status!=2 && bargainId==null&&!isVir" v-on:click="GoBuy(form.ClassPrice)" style="float:right;margin-top: 7px;width: 25%;border-top-right-radius:55px;border-bottom-right-radius:55px;color: white;font-size: 15px;height: 35px;background-color: #4395ff;"  >
							立即购买
						</div>
						<div class="div-inline" v-if="status!=2 && bargainId==null&&isVir" v-on:click="GoBuy(form.ClassPrice)" style="float:right;margin-top: 7px;width: 25%;border-top-right-radius:55px;border-bottom-right-radius:55px;color: white;font-size: 15px;height: 35px;background-color: #4395ff;"  >
							限时优惠
						</div>
						<div class="div-inline" v-if="status!=2 && bargainId!=null" v-on:click="GoBuy(form.ClassPrice)" style="float:right;margin-top: 7px;width: 25%;border-radius:55px;color: white;font-size: 15px;height: 35px;background-color: #4395ff;"  >
							立即购买
						</div>
						<div class="div-inline" v-if="status!=2 && bargainId==null" v-on:click="AddCar()" style="float:right;margin-top: 7px;width: 25%;border-top-left-radius:55px;border-bottom-left-radius:55px;color: white;font-size: 15px;height: 35px;background-color: #70aefe;"  >
							加入购物车
						</div>	
									
					</header>
					<div v-if="form.IsHelp=='1' && status!=2" role="alert" class="el-notification right" style="top: 275px;z-index: 2000;width: 60px;border-radius:100px;background-color: #ff8a00;height: 60px;" v-on:click="GoHelp()">
						<div class="el-notification__group" style="margin-left: 5px;margin-top: 5px;">
							<div class="el-notification__title" style="font-size: 12px;color: white;width: 30px;height: 12px;" >助力</div>
						</div>
					</div>
	            </div>
	        </fieldset>
	    </form>  	
        
		
  	</div>
  	



	
</body>


<script>
	var openid = '@ViewBag.Openid';
	var classid='@ViewBag.ClassId';
	var status='@ViewBag.OrderStatus';
	var videoVue=new Vue({
		el:"#myVideo",
		data:{
			currVideoUrl:"",			
			imgUrl:'',
			isVideo:false
		}
	});
	var detailVue=new Vue({
		el:"#detail",
		data:{
			activeName:'first',
			capData:[],	
			form:{},
			bargainId:"",
			orderNo:"",
			nowPrice:"",
			ClickCount:0,
			isLike:false,
			likeCount:0,
			isVir:false,
			endTime:"",
			HotCount:0,
			NowCount:0,
			NeedCount:0,
			GroupPrice:0,
			orderNo:"",	
			isFunds:false,
			fundsForm:{}
		},
		created: function () {
                this.Query();
         },
         methods:{
         	Query:function () {  
			    var _self = this;
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxClass/GetClassByKey?pGuid=" + guid(),
                    data: {
                        classid:classid
                    },
                    success: function (result) { 
                    	
                        _self.form=result; 
                        if(result.ClassPrice!=result.VirPrice)
                        {
                        	_self.isVir=true;
                        }
                        videoVue.imgUrl=result.ClassImages;
                        $('#contentData').html("<div class='default-content'>" + result.ClassContent + "</div>");
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                }); 
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxClass/GetChaptersByClassKey?pGuid=" + guid(),
                    data: {
                        classid:classid
                    },
                    success: function (result) {
                    	
                       _self.capData = result;
                       if(result.length!=0)
                       {
                       		videoVue.currVideoUrl=result[0].VideoUrl;
                       		var fix=videoVue.currVideoUrl.substring(videoVue.currVideoUrl.length-3);
                       		if(fix=="mp4")
                       		{
                       			videoVue.isVideo=true;
                       		}
                       		else
                       		{
                       			videoVue.isVideo=false;
                       		}
                       }
                        
                        
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                }); 
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxClass/GetClickCountById?pGuid=" + guid(),
                    data: {
                        id:classid
                    },
                    success: function (result) { 
                        _self.ClickCount = result.length; 
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                });  
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxClass/GetLikeByOpenidAndId?pGuid=" + guid(),
                    data: {
                    	openid:openid,
                        id:classid
                    },
                    success: function (result) { 
                    	if(result.LikeLogId==null)
                    	{	
                        	_self.isLike = false
                    	}
                    	else
                    	{
                    		_self.isLike = true
                    	}
                        	
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                }); 
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxClass/GetLikeById?pGuid=" + guid(),
                    data: {
                        id:classid
                    },
                    success: function (result) { 
                    	_self.likeCount = result.length; 
                        	
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                }); 
                _self.GetGroupBuyConfig();               
                _self.GetBargainConfig();
                _self.GetHelpConfig();
                _self.GetBargain();  
                _self.GetFundsConfig();
			},
			GoLike:function(){
				var _self = this;
				var type="1";
				var id=classid;
				$.ajax({
                    type: "post",
                    dataType: "json",
                    url: "/WxClass/Like?pGuid=" + guid(),
                    data: {
                    	obType:type,
						id:id,
						openid:openid
                    },
                    success: function (result) {
                    	_self.Query();
                    },
                    error: function (json) {
                        
                    }
                });
			},
			ChangeDateFormat:function(timeSpan) {
				    var timeSpan = timeSpan.replace('Date','').replace('(','').replace(')','').replace(/\//g,'');
				    var d = new Date(parseInt(timeSpan));
				    return d;
			},
			GetGroupBuyConfig:function(){
				var _self = this;
				//获取团购时间，并判断是否在时间内
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxOrder/GetGroupBuyConfigByClassId?pGuid=" + guid(),
                    data: {
                        classid:classid
                    },
                    success: function (result) { 
                    	var nowDate = new Date(); 
                    	if(result.StartTime!=undefined && result.EndTime!=undefined)
                    	{
                    		if(nowDate>_self.ChangeDateFormat(result.StartTime) && nowDate<_self.ChangeDateFormat(result.EndTime))
	                    	{
	                    		detailVue.form.IsGroupBuy="1";
	                    		_self.isGroupBuy="1";
	                    		$.ajax({
				                    type: "get",
				                    dataType: "json",
				                    contentType: "application/json",
				                    url: "/WxOrder/GetGbClass?pGuid=" + guid(),
				                    data: {
				                        classId:classid
				                    },
				                    success: function (result) { 
				                        _self.HotCount=result.HotCount;   
				                        _self.NowCount=result.NowCount;  
				                        _self.NeedCount=result.NeedCount;				                        
				                        _self.endTime=_self.ChangeDateFormat(result.EndTime);
				                        _self.GroupPrice=result.GroupPrice;
				                        countTime();
				                    },
				                    error: function (json) {
				                        _self.$message.error('查询失败');
				                    }
				                });   
	                    	}
	                    	else
	                    	{
	                    		detailVue.form.IsGroupBuy="0";
	                    		//_self.isGroupBuy="0";
	                    	}    
                    	}
                    	
                    }
                }); 
			},
			GetBargainConfig:function(){
				var _self = this;
				//获取砍价时间，并判断是否在时间内
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxOrder/GetBargainConfigByClassId?pGuid=" + guid(),
                    data: {
                        classid:classid
                    },
                    success: function (result) { 
                    	var nowDate = new Date();
                    	if(result.StartTime!=undefined && result.EndTime!=undefined)
                    	{
                    		if(nowDate>_self.ChangeDateFormat(result.StartTime) && nowDate<_self.ChangeDateFormat(result.EndTime))
	                    	{
	                    		detailVue.form.IsBargain="1";
	                    	}
	                    	else
	                    	{
	                    		detailVue.form.IsBargain="0";
	                    	}    
                    	}
                    }
                }); 
			},
			GetHelpConfig:function(){
				var _self = this;
				//获取助力时间，并判断是否在时间内
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxOrder/GetHelpConfigByClassId?pGuid=" + guid(),
                    data: {
                        classid:classid
                    },
                    success: function (result) { 
                    	var nowDate = new Date();
                    	if(result.StartTime!=undefined && result.EndTime!=undefined)
                    	{
                    		if(nowDate>_self.ChangeDateFormat(result.StartTime) && nowDate<_self.ChangeDateFormat(result.EndTime))
	                    	{
	                    		detailVue.form.IsHelp="1";
	                    	}
	                    	else
	                    	{
	                    		detailVue.form.IsHelp="0";
	                    	}    
                    	}
                    }
                }); 
			},
			GetFundsConfig:function(){
				
				var _self = this;
				//获取砍价时间，并判断是否在时间内
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxOrder/GetFundsConfigByClassId?pGuid=" + guid(),
                    data: {
                        classid:classid
                    },
                    success: function (result) {
                    	if(result.PublicFundsId!=null)
                    	{
							_self.isFunds=true;
                    		_self.fundsForm=result;                 		
                    	}
                    	
//                  	var nowDate = new Date();
//                  	if(result.StartTime!=undefined && result.EndTime!=undefined)
//                  	{
//                  		if(nowDate>_self.ChangeDateFormat(result.StartTime) && nowDate<_self.ChangeDateFormat(result.EndTime))
//	                    	{
//	                    		detailVue.form.IsBargain="1";
//	                    	}
//	                    	else
//	                    	{
//	                    		detailVue.form.IsBargain="0";
//	                    	}    
//                  	}
                    }
                }); 
			},
			changeVideo:function(item){
				if(status==2)
				{
					videoVue.currVideoUrl=item.VideoUrl;
               		var fix=videoVue.currVideoUrl.substring(videoVue.currVideoUrl.length-3);
               		if(fix=="mp4")
               		{
               			videoVue.isVideo=true;
               			
               		}
               		else
               		{
               			videoVue.isVideo=false;
               		}
				}
				
			},
			GoGroupBuy:function()
			{
				//window.location.href = "../WxOrder/GroupBuy?classId="+classid;
				var _self = this;	
				var param={
					classids:"",
					openid:openid,
					source:"3",
					price:_self.GroupPrice
				}
				
				param.classids=classid+"|";
				
				$.ajax({
                    type: "post",
                    dataType: "json",
                    url: "/WxOrder/AddOrder?pGuid=" + guid(),
                    data:param,
                    success: function (result) {
                    	window.location.href =result;
                    	//_self.orderNo=result;
                    	//window.location.href = "/WxOrder/Index?openid=" + openid+"&&orderNo="+_self.orderNo;
                    },
                    error: function (json) {
                        
                    }
                });
			},
			GoBargain:function(price)
			{
				var _self = this;
				$.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxOrder/AddBargain?pGuid=" + guid(),
                    data: {
                        openid:openid,
                        classid:classid,
                        price:price
                    },
                    success: function (result) { 
                        //_self.bargainId = result; 
                        window.location.href = result;
                        //window.location.href = "../WxOrder/Bargain?bargainid="+_self.bargainId;
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                });  
                
			},
			GoBuy:function(price)
			{
				var _self = this;	
				
				var realPrice=price;
				
				if(_self.bargainId!='' && _self.bargainId!=null )
				{
					realPrice=_self.nowPrice;
					var source="2";
				}
				else
				{
					var source="1";
				}
				
				
				var param={
					classids:"",
					openid:openid,
					source:source,
					price:realPrice
				}
				param.classids=classid+"|";
				
				$.ajax({
                    type: "post",
                    dataType: "json",
                    url: "/WxOrder/AddOrder?pGuid=" + guid(),
                    data:param,
                    success: function (result) {
                    	//_self.orderNo=result;
                    	window.location.href = result;
                    },
                    error: function (json) {
                        
                    }
                });
				
			},
			AddCar:function()
			{
				var _self = this;
				$.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxMy/AddCar?pGuid=" + guid(),
                    data: {
                        openid:openid,
                        classId:classid
                    },
                    success: function (result) { 
                	    _self.$message({
                                type: 'success',
                                message: '成功加入购物车!'
                           });
                    },
                    error: function (json) {
                        _self.$message.error('加入失败');
                    }
                }); 
			},
			GoHelp:function(){
				
                window.location.href = "/WxOrder/HelpClass?classid="+classid+"&&ownOpenid="+openid;
                
			},
			GetBargain:function()
			{
				var _self = this;
				//获取团购时间，并判断是否在时间内
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxOrder/GetBargainByOpenIdAndClassId?pGuid=" + guid(),
                    data: {
                        ClassId:classid,
                        openId:openid
                    },
                    success: function (result) {     
                    	_self.bargainId=result.BargainId;
                    	_self.nowPrice=result.NowPrice;
                    }
                }); 
			},
			
         }
	});
	
	 function guid() {
        function S4() {
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }
        return (S4() + S4() + "-" + S4() + "-" + S4() + "-" + S4() + "-" + S4() + S4() + S4());
    }
	 
	 
	 function GoCar()
	 {
	 	window.location.href = "/WxMy/MyCar?code=null&&state=null";
	 }
	 
	 function GoHome()
	 {
	 	window.location.href = "/WxHome/Index?code=null&&state=null";
	 }

	
	 function countTime() {
              //获取当前时间  
              var date = new Date();  
             var now = date.getTime();  
             //设置截止时间  
             var str=detailVue.endTime;
             var endDate = new Date(str); 
             var end = endDate.getTime();               
             //时间差  
             var leftTime = end-now; 
             //定义变量 d,h,m,s保存倒计时的时间  
             var d,h,m,s;  
             if (leftTime>=0) {  
                 d = Math.floor(leftTime/1000/60/60/24);  
                 h = Math.floor(leftTime/1000/60/60%24);  
                 m = Math.floor(leftTime/1000/60%60);  
                 s = Math.floor(leftTime/1000%60);                     
             }  
             //将倒计时赋值到div中  
             document.getElementById("_d").innerHTML = d+"天";  
             document.getElementById("_h").innerHTML = h+"时";  
             document.getElementById("_m").innerHTML = m+"分";  
             document.getElementById("_s").innerHTML = s+"秒";  
             //递归每秒调用countTime方法，显示动态时间效果  
             setTimeout(countTime,1000);  
   
         }  
</script>
