
@{
     ViewBag.Title = "我的课程";
}


<style>
.am-btn-this
{
	display:inline-block;
	margin-bottom:0;
	/*padding:.5em 1em;*/
	vertical-align:middle;
	font-size:0.6rem;
	font-weight:400;
	text-align:center;
	white-space:nowrap;
	background-image:none;
	border:1px solid transparent;
	border-radius:0;
	cursor:pointer;
	outline:0;
	-webkit-appearance:none;
	-webkit-user-select:none;
	-moz-user-select:none;
	-ms-user-select:none;
	user-select:none;
	-webkit-transition:background-color .3s ease-out,border-color .3s ease-out;transition:background-color .3s ease-out,border-color .3s ease-out;
}

.zoomImage{
    width:100%;
    height:0;
    padding-bottom: 75%;
    overflow:hidden;
    background-position: center center;
    background-repeat: no-repeat;
    -webkit-background-size:cover;
    -moz-background-size:cover;
    background-size:cover;
}
</style>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="yes" name="apple-mobile-web-app-capable" />
	<meta content="black" name="apple-mobile-web-app-status-bar-style" />
	<meta content="telephone=no" name="format-detection" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta charset="UTF-8" />
    <title>我的课程</title>
</head>
<body>  	
  	<div id="myIndex">
  		<div class="am-input-group" style="margin-top: 5px;">
    	  <img class="am-header-icon-custom" style="width: 85px;margin-top: 3px;margin-left: 10px;" src="~/Images/icon/logo.png" alt=""/>
	      <input type="text" v-model="txtTitle" class="am-form-field" 
	      	style="border-top-left-radius:5px;border-bottom-left-radius:5px;float:right;width: 60%;" placeholder="输入关键词">
		      <span class="am-input-group-btn" style="padding-right: 5px;">
		        <button class="am-btn am-btn-default" type="button" v-on:click="QueryAll()" style="border-top-right-radius:5px;border-bottom-right-radius:5px;"><span class="am-icon-search"></span> </button>
		      </span>
	    </div>
	    <div class="block" style="margin-top: 5px;">
		    <el-carousel height="160px">
		      <el-carousel-item v-for="item in imagesList" :key="item">		      	
		      	<div class="zoomImage" v-on:click="GoPicture(item)" v-bind:style="{backgroundImage:'url(' + item.ImageUrl + ')'}"></div> 
		      </el-carousel-item>
		    </el-carousel>
		</div>
		<div style="height: 100px;margin-top: 15px;">
			<div class="div-inline" v-on:click="GoClassList()"  style="float:left;width: 18%;margin-left: 10px;"  >
				<img style="height: 60px;" class="am-header-icon-custom" src="~/Images/icon/home_class.png" alt=""/><div style="padding-top: 6px;">精品课程</div>
			</div>	
			<div class="div-inline" v-on:click="GoActivists()"  style="float:left;width: 18%;margin-left: 25px;"  >
				<img style="height: 60px;" class="am-header-icon-custom" src="~/Images/icon/home_gif.png" alt=""/><div style="padding-top: 6px;">线下活动</div>
			</div>	
			<div class="div-inline" v-on:click="GoLaws()"  style="float:left;width: 18%;margin-left: 25px;"  >
				<img style="height: 60px;" class="am-header-icon-custom" src="~/Images/icon/home_traffic.png" alt=""/><div style="padding-top: 6px;">法规快递</div>
			</div>
			<div class="div-inline" v-on:click="GoMy()"  style="float:left;width: 18%;margin-left: 25px;"  >
				<img style="height: 60px;" class="am-header-icon-custom" src="~/Images/icon/home_my.png" alt=""/><div style="padding-top: 6px;">专家访谈</div> 
			</div>	
		</div>
    	
    	<div style="width: 100%;height: 15px;background: #E0E0E0;"></div>
    	
    	<div data-am-widget="list_news" class="am-list-news am-list-news-default" 
    		style="margin-top:0px;">		
		  	<div class="am-list-news-hd am-cf">
		          <h2>精品推荐</h2>
		            <span v-on:click="GoClassList()" class="am-list-news-more am-fr">查看全部 &raquo;</span>  
          	</div>
			  
		  	<div class="am-list-news-bd">
				  <ul class="am-list" v-for="item in myClassList">
				     <!--缩略图在标题左边-->
				      <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left" 
				      	style="padding-top: 5px;padding-bottom: 5px;height: 110px;">
				        <div class="am-u-sm-4 am-list-thumb" style="width: 49%;height: 100%;padding-right: 0px;max-height: 100px;">
				        	<div class="zoomImage" style="height: 100px;" v-bind:style="{backgroundImage:'url(' + item.ClassImages + ')'}"></div>
				        </div>
						<table class=" am-u-sm-8 am-list-main" style="width: 49%;height: 100%;position:relative;" v-on:click="GoClassDetail(item)">
							<tr>
								<td colspan="2">
									<div style="color: #444444;overflow: hidden;height: 40px;"><b>{{item.ClassName}}</b></div>									
								</td>
								
							</tr>
							<tr>
								<td colspan="2">
									<div style="color: #999999;font-size: 12px;overflow: hidden;height: 35px;">{{item.ClassAbstract}}</div>									
								</td>
								
							</tr>
							<tr>
								
								<td>
									<div style="font-size: 11px;color:#FFD306">{{item.ClassTeacher}}</div>
								</td>
								
							</tr>
						</table>				        
				      </li>  
				    </ul>
			</div>
		</div>
		
		<div style="width: 100%;height: 15px;background: #E0E0E0;"></div>
		
		<div data-am-widget="list_news" class="am-list-news am-list-news-default" 
			style="margin-top:0px;min-height:558px ;">		
		  	<div class="am-list-news-hd am-cf">
		        <h2>近期新课</h2>
          	</div>
			  
		  	<div class="am-list-news-bd">
				  	<ul class="am-list" v-for="item in newClassList">
				      <li style="float: left;width: 50%;padding: 5px;" v-on:click="GoClassDetail(item)">
				        <div style="width: 100%;height: 30%;">
				        	<div class="zoomImage" style="height: 100px;" v-bind:style="{backgroundImage:'url(' + item.ClassImages + ')'}"></div>
				        	<!--<img style="height: 100px;" :src="item.ClassImages"/>-->
				        </div>	
				        <div style="overflow: hidden;height: 40px;">
				        	{{item.ClassName}}
				        </div>
				        <div>
				        	<div style="color: red;width: 50%;float: left;">¥{{item.ClassPrice}}</div>
				        	<div style="font-size: 14px;color:#999999;float: right;">{{item.HotCount}} 人学习</div>
				        </div>
				      </li>  
				    </ul>
			</div>
		</div>
  	
  		<div style="width: 100%;height: 15px;background: #E0E0E0;"></div>
  	
  		<div data-am-widget="list_news" class="am-list-news am-list-news-default" 
  			style="margin-top:0px;">		
		  	<div class="am-list-news-hd am-cf">
		        <h2>最新资讯</h2>	
          	</div>
			
			<div class="am-list-news-bd">
			  <ul class="am-list" v-for="item in activityList">
			      <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left" style="padding-top: 5px;padding-bottom: 5px;height: 80px;">
			        <div class="am-u-sm-4 am-list-thumb" style="width: 30%;height: 70px;padding-right: 0px;">
			        	<img :src="item.ImageUrl"/>
			        </div>
			
					<table class=" am-u-sm-8 am-list-main" style="height: 70px;position:relative;" v-on:click="GoNewsDetail(item)">
						<tr>
							<td style="height: 30px;">
								<div class="am-list-item-hd" style="color: black;height:44px; overflow:hidden;">
			            			{{item.ArticleTitle}}
			            		</div>								
							</td>
						</tr>
						<tr>
							<td>
								<div style="color: #999999;float: right;padding-top: 5px"><img style="margin-right: 3px;" class="am-header-icon-custom" src="~/Images/icon/眼睛.png" alt=""/>{{item.ClickCount}}</div>
								<div style="color: #999999;float: right;padding-top: 5px;margin-right: 10px;"><img style="margin-right: 3px;" class="am-header-icon-custom" src="~/Images/icon/日历.png" alt=""/>{{item.CreateTime}}</div>
							</td>
							
						</tr>
					</table>				        
			      </li>  
			    </ul>
		  </div>
		  	
		</div>
  	
  	</div>
  	
</body>


<script>
	var openid = '@ViewBag.Openid';
	var myIndexVue=new Vue({
		el:"#myIndex",
		data:{
			myClassList:[],
			activityList:[],
			newClassList:[],
			txtTitle:"",
			classCount:0,
			imagesList:[]
		},
		created: function () {
                this.Query()
         },
         methods:{
         	Query:function () {  
			    var _self = this;
                var title = this.txtTitle;
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxClass/GetClassByType?pGuid=" + guid(),
                    data:{
                    	type:"2",                  	
                    },
                    success: function (result) {                       
                        _self.myClassList = result;
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                });
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxClass/GetNewestClass?pGuid=" + guid(),
                    success: function (result) {                       
                        _self.newClassList = result;
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                });
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxArticle/GetAllArticlesByType?pGuid=" + guid(),
                    data: {
                    	type:"2"
                    },
                    success: function (result) {
                        $.each(result, function(index,value) {
                    		var date=value.CreateTime;                    		
                    		var ncd=new Date(parseInt(date.substr(6, 13))); 
                    		var y = ncd.getFullYear();  
						    var m = ncd.getMonth() + 1;  
						    m = m < 10 ? '0' + m : m;  
						    var d = ncd.getDate();  
						    d = d < 10 ? ('0' + d) : d; 
                    		value.CreateTime= m + '-' + d;
                    	});
                        _self.activityList = result;
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                });
                $.ajax({
                    type: "get",
                    dataType: "json",
                    contentType: "application/json",
                    url: "/WxHome/GetAllIndexImages?pGuid=" + guid(),
                    success: function (result) {                        
                        _self.imagesList = result;
                    },
                    error: function (json) {
                        _self.$message.error('查询失败');
                    }
                });
			},
			QueryAll:function (){
				var title = this.txtTitle;
				window.location.href = "/WxHome/IndexSearch?openid="+openid+"&&condition="+title;
			},
			GoClassList:function(){
				window.location.href = "/WxClass/ClassList";
			},
			GoActivists:function(){
				window.location.href = "/WxArticle/Activists";
			},
			GoLaws:function(){
				window.location.href = "/WxArticle/Laws";
			},
			GoMy:function(){
				window.location.href = "/WxClass/ExpertViewList";
			},
			GoClassDetail:function(item){
				var type="1";
				var id=item.ClassId;
				$.ajax({
                    type: "post",
                    dataType: "json",
                    url: "/WxBase/ClickLog?pGuid=" + guid(),
                    data: {
                    	obType:type,
						id:id,
						openid:openid
                    },
                    success: function (result) {
                    },
                    error: function (json) {
                        
                    }
                });
				window.location.href = "/WxClass/ClassDetail?openid=" + openid+"&&classId="+id;
			},
			GoNewsDetail:function(item){
				var type="2";
				var id=item.ArticleId;
				$.ajax({
                    type: "post",
                    dataType: "json",
                    url: "/WxBase/ClickLog?pGuid=" + guid(),
                    data: {
                    	obType:type,
						id:id,
						openid:openid
                    },
                    success: function (result) {
                    },
                    error: function (json) {
                        
                    }
                });
				window.location.href = item.ImageLink;
			},
			GoPicture:function(item){
				window.location.href=item.ImageLink;
			}
         }
	});
	
	 function guid() {
        function S4() {
            return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
        }
        return (S4() + S4() + "-" + S4() + "-" + S4() + "-" + S4() + "-" + S4() + S4() + S4());
    }
	
</script>
